<div class="post-header">
    <h2>Escape Room</h2>
    <h4>üößEn construcci√≥nüöß</h4>
</div>

<style>
.code-container {
  text-align: center;
  padding: 20px;
}

.code-inputs {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin: 20px 0;
}

.code-input {
  width: 60px;
  height: 80px;
  border: 3px solid #666;
  border-radius: 12px;
  text-align: center;
  font-size: 40px;
  font-weight: bold;
  text-transform: uppercase;
  background: #f8f8f8;
}

#checkButton {
  padding: 12px 40px;
  font-size: 20px;
  background-color: #00C851;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s;
}

.error { border-color: #ff4444 !important; }
.success { border-color: #00C851 !important; }
</style>

<div class="post-content">
    <p id="storyText">amanece y la anciana quiere ir al huerTo a por un Higo. intenta abrir la puerta, pero en vez de llave Tiene un c√≥digo, y no lo recuerda.</p>
</div>

<div class="code-container">
  <div class="code-inputs">
    <input type="text" class="code-input" id="input1" maxlength="1">
    <input type="text" class="code-input" id="input2" maxlength="1">
    <input type="text" class="code-input" id="input3" maxlength="1">
  </div>
  <button id="checkButton">Abrir puerta</button>
</div>

<script>
// Configuraci√≥n del Juego (Modo Depuraci√≥n)
const JUEGO = {
  solucion: 'THT',  // ¬°SOLUCI√ìN CORRECTA DEFINIDA AQU√ç!
  inputs: [],
  
  init() {
    this.inputs = [...document.querySelectorAll('.code-input')];
    console.log('Iniciando juego... Soluci√≥n correcta:', this.solucion);
    
    this.inputs.forEach((input, index) => {
      input.addEventListener('input', (e) => {
        this.procesarInput(e, index);
        console.log(`Input ${index + 1}:`, e.target.value);
      });
    });

    document.getElementById('checkButton').addEventListener('click', () => {
      console.log('Bot√≥n pulsado. C√≥digo ingresado:', this.getCodigoActual());
      this.verificarCodigo();
    });
  },

  procesarInput(e, index) {
    const input = e.target;
    input.value = input.value.toUpperCase().replace(/[^A-Z]/g, '').substr(0,1);
    
    // Navegaci√≥n autom√°tica mejorada
    if(input.value) {
      if(index < 2) this.inputs[index + 1].focus();
    } else {
      if(index > 0) this.inputs[index - 1].focus();
    }
  },

  getCodigoActual() {
    return this.inputs.map(i => i.value).join('');
  },

  verificarCodigo() {
    const combinacion = this.getCodigoActual();
    console.log('Verificando:', combinacion);
    
    if(combinacion === this.solucion) {
      console.log('¬°C√≥digo correcto!');
      this.mostrarExito();
      setTimeout(() => {
        console.log('Avanzando al Puzzle 2...');
        this.siguienteNivel();
      }, 1500);
    } else {
      console.log('C√≥digo incorrecto');
      this.mostrarError();
    }
  },

  mostrarExito() {
    this.inputs.forEach(input => input.classList.add('success'));
    document.getElementById('checkButton').style.backgroundColor = '#007E33';
    document.getElementById('storyText').textContent = "¬°Correcto! La puerta se abre...";
  },

  mostrarError() {
    this.inputs.forEach(input => {
      input.classList.add('error');
      setTimeout(() => input.classList.remove('error'), 1000);
    });
  },

  siguienteNivel() {
    document.getElementById('storyText').innerHTML = `
      ¬°√âxito! La puerta revela un cofre con s√≠mbolos: ‚ØÅ‚ô£‚ò¢.<br>
      <strong>Nuevo c√≥digo requerido:</strong> "Las iniciales de Tres Hijos del Tendero"
    `;
    document.querySelector('.code-container').innerHTML = `
      <div style="margin-top:30px; font-size:1.2em">
        <p>${document.getElementById('storyText').innerHTML}</p>
        <button onclick="location.reload()" 
                style="margin-top:20px; padding:10px 20px; font-size:16px">
          Reiniciar Juego
        </button>
      </div>
    `;
  }
};

// Iniciar con logs de diagn√≥stico
window.addEventListener('DOMContentLoaded', () => {
  console.log('DOM completamente cargado');
  JUEGO.init();
});
</script>

<div class="post-footer">
    <a href="../tantoshigostanto/glosario.html#escape-room" class="read-more">Explicaci√≥n del recurso ‚Üí</a>
</div>
